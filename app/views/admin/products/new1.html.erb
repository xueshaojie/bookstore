<div>
  <h1><%= @product.new_record? ? "新建商品" : "修改商品 ##{params[:id]}" %></h1>
</div>

<div class="form-body">
  <%= form_for @product,
    url: (@product.new_record? ? admin_products_path : admin_product_path(@product)),
    method: (@product.new_record? ? 'post' : 'put'),
    html: { class: 'form-horizontal' } do |f| %>

    <% unless @product.errors.blank? %>
      <div class="alert alert-danger">
        <ul class="list-unstyled">
          <% @product.errors.messages.values.flatten.each do |error| %>
            <li><i class="fa fa-exclamation-circle"></i> <%= error %></li>
          <% end -%>
        </ul>
      </div>
    <% end -%>


    <div class="form-group">
      <label for="title" class="col-sm-2 control-label">名称*:</label>
      <div class="col-sm-5">
        <%= f.text_field :title, class: "form-control" %>
      </div>
    </div>
    <div class="form-group">
      <label for="category_id" class="col-sm-2 control-label">所属分类:</label>
      <%#= select_tag(:category_id, options_for_select(@categories), :prompt => "类别") %>
      <div class="col-sm-5">
        <select name="product[category_id]">
          <option></option>
          <% @categories.each do |category| %>
            <option value="<%= category.id %>" <%= @product.category_id == category.id ? 'selected' : '' %>><%= category.name %></option>
          <% end -%>
        </select>
      </div>
    </div>

    <div class="form-group">
      <label for="author" class="col-sm-2 control-label">作者*:</label>
      <div class="col-sm-5">
        <%= f.text_field :author, class: "form-control" %>
      </div>
    </div>

    <div class="form-group">
      <label for="amount" class="col-sm-2 control-label">库存*:</label>
      <div class="col-sm-5">
        <%= f.text_field :amount, class: "form-control" %> 必须为整数
      </div>
    </div>
    <div class="form-group">
      <label for="price" class="col-sm-2 control-label">价格*:</label>
      <div class="col-sm-5">
        <%= f.text_field :price, class: "form-control" %>
      </div>
    </div>
    <div class="form-group">
      <label for="description" class="col-sm-2 control-label">描述*:</label>
      <div class="col-sm-5">
        <%= f.text_area :description, class: "form-control" %>
      </div>
    </div>

    <div class="form-group">
      <label for="image" class="col-sm-2 control-label">图片*:</label>
      <div class="col-sm-5">
          <%= f.file_field :image, class: "form-control" %>
        <% end %>
      </div>
    </div>


    <div class="form-group">
      <div class="col-sm-offset-2 col-sm-8">
        <%= f.submit (@product.new_record? ? "新建商品" : "编辑商品"), class: "btn btn-default" %>
      </div>
    </div>
  <% end -%>
</div>

<div class="container">
  <div class="row">
    <div class="col-md-8">
      <h2 class="text-center">新增商品</h2>


          <%= simple_form_for [:admin, @product] do |f| %>
            <div class="form-group">
              <%= f.input :title, :label => "商品名称" %>
              <%= f.input :category_id, label: "分类", required: true, as: :select, collection: @categories %>
              <%= f.input :description, :label => "简述" %>
              <%= f.input :amount, :label => "库存" %>
              <%= f.input :price, :label => "价格" %>
              <%= f.input :author, :label => "作者" %>
              <%= f.input :image, as: :file, :label => "图片" %>
              <hr>

            </div>
            <%= f.submit "提交", class: "btn btn-sm btn-default", data: {disable_with: "Submiting..."} %>
          <% end %>
        </div>
    </div>
</div>
